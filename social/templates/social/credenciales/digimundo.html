{% extends 'social/feed.html' %}
{% load static%}
{% block content %}
<!-- librerias js -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.js"></script>
<script src="https://unpkg.com/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<!-- fin -->
<style>
    /* responsive de telefono */
    @media(min-width:300px) {

        /* en frente */
        .credencial .lateral {
            position: absolute;
            transform: translateX(255px);
            width: 45px;
            height: 60vh;
            margin-top: -15px;
        }

        .foto {
            width: calc(100% - 35px);
            height: calc(85% - 30px);
        }

        .lateral img {
            width: 150px;
            height: 5vh;
            margin-top: 110px;
            margin-left: -50px;
            transform: rotate(-90deg);
        }

        .icono {
            position: absolute;
            width: 50px;
            height: 60px;
            padding: 15px;
        }

        .credencial .nombre {
            transform: rotate(0.95turn);
            font-weight: bold;
            font-size: 20px;
            width: 200%;
            display: flex;
            justify-content: center;
            margin: -50px 0px 0px -150px;
        }

        .credencial .puesto {
            transform: rotate(0.95turn);
            width: 200%;
            font-weight: bold;
            font-size: 20px;
            display: flex;
            justify-content: center;
            margin: 0px 0px 0px -150px;
        }

        .credencial .vacio {
            transform: rotate(0.95turn);
            width: 200%;
            height: 200px;
            display: flex;
            justify-content: center;
            margin: 0px 0px 0px -150px;
        }

        /* parte de atras */
        .reverso .uno {
            transform: rotate(0.95turn);
            width: 200%;
            height: 70px;
            margin: -50px 0px 0px -150px;
        }

        .reverso .dos {
            transform: rotate(0.95turn);
            width: 200%;
            height: 60px;
            margin: 0px 0px 0px -150px;
        }

        .reverso .tres {
            transform: rotate(0.95turn);
            font-weight: bold;
            width: 200%;
            height: 60px;
            display: flex;
            justify-content: center;
            margin: 0px 0px 0px -150px;
        }

        .reverso .lateral {
            position: absolute;
            width: 50px;
            height: 80vh;
            margin-bottom: 200px;
        }

        .reverso .lateral img {
            width: 150px;
            height: 5vh;
            margin-top: 350px;
            margin-left: -50px;
            transform: rotate(-90deg);
        }

        .reverso .icono {
            position: absolute;
            transform: translateY(480px) translateX(130px);
            width: 50px;
            height: 60px;
            padding: 15px;
        }
    }
/* responsive tablet */
    @media(min-width:600px) {

        .credencial,
        .reverso {
            width: 320px;
            height: 60vh;
        }

        /* en frente */
        .credencial .lateral {
            position: absolute;
            transform: translateX(275px);
            width: 45px;
            height: 60vh;
            margin-top: -15px;
        }

        .lateral img {
            width: 150px;
            height: 4vh;
            margin-top: 100px;
            margin-left: -50px;
            transform: rotate(-90deg);
        }

        .icono {
            position: absolute;
            width: 50px;
            height: 60px;
            padding: 15px;
        }

        .credencial .nombre {
            transform: rotate(0.95turn);
            font-weight: bold;
            font-size: 20px;
            width: 200%;
            display: flex;
            justify-content: center;
            margin: -60px 0px 0px -150px;
        }

        .credencial .puesto {
            transform: rotate(0.95turn);
            width: 200%;
            font-weight: bold;
            font-size: 20px;
            display: flex;
            justify-content: center;
            margin: 0px 0px 0px -150px;
        }

        .credencial .vacio {
            transform: rotate(0.95turn);
            width: 200%;
            height: 200px;
            display: flex;
            justify-content: center;
            margin: 0px 0px 0px -150px;
        }

        /* parte de atras */
        .reverso .uno {
            transform: rotate(0.95turn);
            width: 200%;
            height: 70px;
            margin: -55px 0px 0px -150px;
        }

        .reverso .dos {
            transform: rotate(0.95turn);
            width: 200%;
            height: 60px;
            margin: 0px 0px 0px -150px;
        }

        .reverso .tres {
            transform: rotate(0.95turn);
            font-weight: bold;
            width: 200%;
            height: 60px;
            display: flex;
            justify-content: center;
            margin: 0px 0px 0px -150px;
        }

        .reverso .lateral {
            position: absolute;
            width: 50px;
            height: 60vh;
            margin-bottom: 200px;
        }

        .reverso .lateral img {
            width: 150px;
            height: 4vh;
            margin-top: 350px;
            margin-left: -50px;
            transform: rotate(-90deg);
        }

        .reverso .icono {
            position: absolute;
            transform: translateY(450px) translateX(135px);
            width: 50px;
            height: 60px;
            padding: 15px;
        }
    }
/* estilos generales*/
    .imagen {
        padding: 20px;
    }

    /*colores principales y tama√±os*/
    .credencial,
    .reverso {
        border-style: solid;
        background-color: white;
        overflow: hidden;
        display: grid;
        grid-template:
            "header" 15px
            "main" auto
            "footer" 15px;
        margin: auto;
        width: 300px;
        height: 80vh;
    }

    .foto {
        width: calc(100% - 35px);
        height: calc(65% - 30px);
    }

    /*asignar areas*/
    .header,
    .footer {
        background-color: #163a69;
        color: #163a69;
    }

    .header {
        position: relative;
        width: calc(100% - 45px);
    }

    .header .lateral {
        grid-area: header;
    }


    .footer {
        grid-area: footer;
    }

    .lateral {
        background-color: #0b63d4;
        color: white;
    }

    /*barras delanteras*/
    .nombre {
        background-color: #163a69;
        color: white;
    }

    .puesto {
        background-color: #7acef3;
        color: white;
    }

    .vacio {
        background-color: #addbe8;
        color: #addbe8;
    }

    /*para los colores de atras*/
    .uno {
        background-color: #addbe8;
        color: #addbe8;
    }

    .dos {
        background-color: #7acef3;
        color: #7acef3;
    }

    .tres {
        background-color: #163a69;
        color: #163a69;
    }

    /*pc*/
    .imagen {
        display: flex;
    }

    .foto {
        width: calc(100% - 35px);
        height: calc(65% - 30px);
    }

    .credencial,
    .reverso {
        width: 300px;
        height: 80vh;
    }

    /* en frente */
    .credencial .lateral {
        position: absolute;
        transform: translateX(255px);
        width: 45px;
        height: 70vh;
        margin-top: -15px;
    }

    .lateral img {
        width: 150px;
        height: 5.2vh;
        margin-top: 100px;
        margin-left: -50px;
        transform: rotate(-90deg);
    }

    .icono {
        position: absolute;
        width: 50px;
        height: 60px;
        padding: 15px;
    }

    .credencial .nombre {
        transform: rotate(0.95turn);
        font-weight: bold;
        font-size: 20px;
        width: 200%;
        display: flex;
        justify-content: center;
        margin: -50px 0px 0px -150px;
    }

    .credencial .nombre h3{
        font-size: 1em;
    }

    .credencial .puesto {
        transform: rotate(0.95turn);
        width: 200%;
        font-weight: bold;
        font-size: 20px;
        display: flex;
        justify-content: center;
        margin: 0px 0px 0px -150px;
    }

    .credencial .vacio {
        transform: rotate(0.95turn);
        width: 200%;
        height: 200px;
        display: flex;
        justify-content: center;
        margin: 0px 0px 0px -150px;
    }

    /* parte de atras */
    .reverso .uno {
        transform: rotate(0.95turn);
        width: 200%;
        height: 60px;
        margin: -50px 0px 0px -150px;
    }

    .reverso .dos {
        transform: rotate(0.95turn);
        width: 200%;
        height: 50px;
        margin: 0px 0px 0px -150px;
    }

    .reverso .tres {
        transform: rotate(0.95turn);
        font-weight: bold;
        width: 200%;
        height: 60px;
        display: flex;
        justify-content: center;
        margin: 0px 0px 0px -150px;
    }

    .reverso .lateral {
        position: absolute;
        width: 50px;
        height: 80vh;
        margin-bottom: 200px;
    }

    .reverso .lateral img {
        width: 150px;
        height: 5.2vh;
        margin-top: 320px;
        margin-left: -50px;
        transform: rotate(-90deg);
    }

    .reverso .icono {
        position: absolute;
        width: 50px;
        height: 60px;
    }
</style>

<div class="imagen" id="imagen">
    {% for user in u %}
    <div class="credencial">
        <div class="header">.</div>
        <main>
            <!-- nombre dept o imagen -->
            <div class="lateral"> <img src="{% static 'tesca/Digimundo.png' %}" class="logo"> </div>
            <!-- icono tesca -->
            <img src="{% static 'tesca/tesca-negro.png' %}" class="icono">
            <!-- foto de perfil -->
            <img src="{{user.profile.image.url}}" class="foto">
            <!-- Datos del usuario -->
            <div class="nombre">
                <h3>{{user.information.first_name}} {{user.information.last_name}} </h3>
            </div>
            <div class="puesto">
                <h3>{{user.information.puesto}}</h3>
            </div>
            <div class="vacio">
                .
            </div>
        </main>
    </div>
    <br>
    <div class="reverso">
        <!-- parte lateral -->
        <div class="lateral"> <img src="{% static 'tesca/Digimundo.png' %}"></div>
        <main>
            <div class="uno">
                .
            </div>
            <div class="dos">
                .
            </div>
            <div class="tres">
                .
            </div>

            <img src="{% url 'generar_codigo_qr' user.id %}" alt="C√≥digo QR de usuario" class="QR-code">
        </main>
        <!-- <img src="{% url 'generar_codigo_qr' user.id %}" alt="C√≥digo QR de usuario" class="QR-code">
 -->
        <div class="footer">.</div>
        <img src="{% static 'tesca/tesca-negro.png' %}" class="icono">
    </div>
    {% endfor %}

</div>

<style>
    .QR-code {
        width: 250px;
        height: 250px;
        margin-left: 15%;
        margin-top: 13%;
    }
</style>
<div style="display: flex; justify-content: center;">
    <button id="download">Descargar</button>
</div>
<!--Descarga?  -->
<script>
    document.getElementById("download").addEventListener("click", function () {
        const element = document.getElementById("imagen");
        // let posibilidad = document.getElementById('fileTitle').value;
        html2canvas(element, {
            backgroundColor: "white", // Establecer el fondo transparente
            scale: 5, // Aumentar la escala para mejorar la calidad
            logging: false, // Desactivar los mensajes de registro (opcional)
            useCORS: true, // Habilitar el uso de CORS para im√°genes externas
            dpi: 900,
            Proxy: true
        }).then(canvas => {
            // Crear un elemento de imagen para obtener la imagen del canvas
            var img = new Image();
            img.src = canvas.toDataURL("image/png");
            // Crea un enlace temporal para forzar la descarga
            var link = document.createElement("a");
            link.download = `Digimundo-credencial.png`;
            link.href = img.src;
            link.click();
        });
    });
</script>
{% endblock %}