{% extends 'social/feed.html' %}
<!--{% load static %}-->
{% block content %}

{%load static%}

<head>
	<script src="https://kit.fontawesome.com/c8ee4f8012.js" crossorigin="anonymous"></script>
</head>
<!-- Profile -->
<div class="profile">
	{% load static from static %}
	<img src="{{user.profile.image.url}}">
	<h2>{{ user.username }}</h2>

	<!-- tabla carlos -->
	<table id="tabla-hats" style="display: none;">
		<thead>
			<tr>
				<th>hat</th>
				<th>valor</th>

			</tr>
		</thead>
		<tbody>
			{% for registros in registros %}
			{% if registros.user_id == user.id %}

			<tr>

				{% for hat in hat %}
				{% if registros.hat_id == hat.id %}

				<td>{{hat.nombre_hat}}</td>
				<td>1</td>
				{% endif %}
				{% endfor %}

			</tr>
			{% endif %}
			{% endfor %}
		</tbody>
		<tfoot>
			<tr>
				<th>Total</th>
				<th>Total</th>
			</tr>
		</tfoot>
	</table>

	<input type="text" id="ganancia_total" style="display: none;">

	<script>
		$(document).ready(function () {
			//Defino los totales de mis 2 columnas en 0
			var total_col1 = 0;
			var total_col2 = 0;
			//Recorro todos los tr ubicados en el tbody
			$('#tabla-hats tbody').find('tr').each(function (i, el) {

				//Voy incrementando las variables segun la fila ( .eq(0) representa la fila 1 )     
				total_col2 += parseFloat($(this).find('td').eq(1).text());
			});
			//Muestro el resultado en el th correspondiente a la columna
			$('#tabla-hats tfoot tr th').eq(1).text("Total " + total_col2);

			total = $('#tabla-hats tfoot tr th').eq(1).text();
			var comisiones_balance = total.split(' ');
			$("#ganancia_total").val(comisiones_balance[1]);
			var ganancia = $('#ganancia_total').val();

			let buttonF = document.querySelector(".btnfuncional");
			let buttonN = document.querySelector(".btnnof");

			if (ganancia >= 4) {
				buttonF.style.display = 'none';
				buttonN.style.display = 'block';
				/* button.style.cursor= "not-allowed"; */

			} else {
				buttonF.style.display = 'block';
				buttonN.style.display = 'none';
			}
		});
	</script>

	<!-- fin tabla carlos -->
	<!-- <h2 style="color: gray;"><span>{{ user.information.first_name }} {{ user.information.last_name }}</span></h2> -->


	<!-- {% if request.user.is_authenticated %}
	{% if user.username != request.user.username %}
	{% if user not in request.user.profile.following %}
	<button><a class="follow-button" href="{% url 'follow' user %}">Siguir</a></button>
	{% else %}
	<button><a class="follow-button" href="{% url 'unfollow' user %}">Seguidor</a></button>
	{% endif %}
	{% endif %}
	{% endif %} -->
</div>

<div class="profile">
	{% if user.is_superuser%}
	<h2><i style="color: gold;" class='fas fa-crown'></i>&nbsp; Eres Admin </h2>
	{%endif%}
</div>

<!--Piso 0 -->
<div class="follow">
	<div>
		{% if user.information.is_leader %}

		<h5 style='padding-bottom: 20px'> <i style="color: gold;" class="fa fa-star" aria-hidden="true"></i>&nbsp;Eres
			Lider
			del equipo {{user.information.departamento}} </h5>

		{% else %}
		<h5 style='padding-bottom: 20px'> <i class="fa fa-users" aria-hidden="true"></i>&nbsp;Eres Parte del equipo
			{{user.information.departamento}}</h5>
		{% endif %}
	</div>
</div>


<h1 style="text-align: center;"> Hats Asignados</h1>
<div class="follow" style="height: 50px; align-items: center;">

	{% for registros in registros %}
			{% if registros.user_id == user.id %}

				{% for hat in hat %}
				{% if registros.hat_id == hat.id %}
				<div style="font-size: 15px;">
					 {{hat.nombre_hat}}
				</div>
				
				{% endif %}
				{% endfor %}
			{% endif %}
			{% endfor %}
		</tbody>
	
</div>


<div class="profile1">
	{%if user.id == user.information.user_id %}
	<div class="profile1">
		<a class="btnInf" style="color: red;">Ya actualizaste tu informacion</a>
	</div>
	{%else%}

	<div class="profile1">
		<a class="btnInf" href="{% url 'information' %}">Actualiza tu informacion</a>
	</div>
	{% endif %}

</div>

<div class="profile1">

	<div class="profile1">
		<a class="btnInf btnfuncional" href="{% url 'asignarhat' %}" style="text-align: center; display: none;">Asigna tu hat</a>
	</div>
	<!-- La validacion para que aparesca un botono o otro esta en el script de arriba que va en conjunto con la tabla -->
	<div class="profile1">
		<a class="btnInf btnnof" style="color: red; text-align: center; display: none;">Haz alcanzado el limite de hats</a>
	</div>

</div>


<!-- PISO 1 -->
<div class="follow">
	<div>
		<h5>Entradas y Salidas Registradas</h5>
		<p>{{ user.posts.count }}</p>
	</div>
</div>

<!-- PISO 2 -->

<div class="follow">
	<div>
		<h5>Nombre Completo</h5>
		<h2 style="color: gray;"><span>{{ user.information.first_name }} {{ user.information.last_name }}</span></h2>
	</div>
</div>

<div class="follow">
	<div>
		<h5>Dirección</h5>
		<p>{{ user.information.direccion }}</p>
	</div>
</div>

<!-- PISO 3 -->

<div class="follow">
	<div>
		<h5>Fecha de nacimiento</h5>
		<p>{{ user.information.nacimiento }}</p>
	</div>
	<div>
		<h5>Teléfono Personal</h5>
		<p>{{ user.information.telefono }}</p>
	</div>
	<div>
		<h5>Teléfono de Casa</h5>
		<p>{{ user.information.telefono_casa }}</p>
	</div>
</div>

<!-- PISO 4 -->

<div class="follow">
	<div>
		<h5>Fecha de ingreso</h5>
		<p>{{ user.egresos.ingreso }}</p>
	</div>
	<div>
		<h5>Fecha de egreso</h5>
		<p>{{ user.egresos.egreso}}</p>
	</div>
	<div>
		<h5>Departamento(s)</h5>
		<p>{{ user.information.departamento }}</p>
	</div>
</div>

<!-- PISO 5 -->

<div class="follow">
	<div>
		<h5>Puesto</h5>
		<p>{{ user.information.puesto }}</p>
	</div>
	<div>
		<h5>Correo</h5>
		<p>{{ user.email }}</p>
	</div>
</div>

<!-- CONTACTO DE EMERGENCIA -->

<div class="follow">
	<div>
		<h5>Contacto de Emergencia</h5>
		<p>{{ user.information.contacto_emergencia }}</p>
	</div>
	<div>
		<h5>Teléfono de Emergencia</h5>
		<p>{{ user.information.telefono_emergencia }}</p>
	</div>
</div>


<div>

</div>


<style>

</style>

{{ block.super }}
{% endblock %}